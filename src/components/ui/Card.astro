---
import type { CollectionEntry } from 'astro:content';
import { formatDate } from '@/utils/formatDate';
import { formatReadingTime } from '@/utils/readingTime';
import TagChip from './TagChip.astro';

interface Props {
  post: CollectionEntry<'posts'>;
  featured?: boolean;
}

const { post, featured = false } = Astro.props;
const { title, description, pubDate, tags, language, readingTime } = post.data;
---

<article class={`group ${featured ? 'col-span-full' : ''}`}>
  <a
    href={`/blog/${post.slug}`}
    class="block p-6 rounded-xl border border-notion-border dark:border-notion-border-dark bg-notion-bg dark:bg-notion-bg-dark hover:border-notion-blue dark:hover:border-notion-blue transition-all duration-200 hover:shadow-lg"
  >
    <div class="flex flex-col gap-3">
      {/* Header */}
      <div class="flex items-start justify-between gap-4">
        <div class="flex-1 min-w-0">
          {language && (
            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-notion-blue-light dark:bg-blue-900/30 text-notion-blue mb-2">
              {language}
            </span>
          )}
          <h3 class={`font-semibold text-notion-text dark:text-notion-text-dark group-hover:text-notion-blue transition-colors ${featured ? 'text-2xl' : 'text-lg'} line-clamp-2`}>
            {title}
          </h3>
        </div>
        {featured && (
          <span class="shrink-0 inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400">
            Featured
          </span>
        )}
      </div>

      {/* Description */}
      <p class={`text-notion-text dark:text-notion-text-dark/70 line-clamp-2 ${featured ? 'text-base' : 'text-sm'}`}>
        {description}
      </p>

      {/* Footer */}
      <div class="flex flex-wrap items-center gap-3 text-sm text-notion-text dark:text-notion-text-dark/60 mt-1">
        <time datetime={pubDate.toISOString()}>
          {formatDate(pubDate)}
        </time>
        {readingTime && (
          <>
            <span>Â·</span>
            <span>{formatReadingTime(readingTime)}</span>
          </>
        )}
      </div>

      {/* Tags */}
      {tags.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-1">
          {tags.slice(0, featured ? 5 : 3).map((tag) => (
            <TagChip tag={tag} size="sm" />
          ))}
          {tags.length > (featured ? 5 : 3) && (
            <span class="text-xs text-notion-text dark:text-notion-text-dark/50 px-2 py-0.5">
              +{tags.length - (featured ? 5 : 3)} more
            </span>
          )}
        </div>
      )}
    </div>
  </a>
</article>
