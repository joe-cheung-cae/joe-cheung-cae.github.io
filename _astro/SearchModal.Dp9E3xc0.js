import{d as c,A as y,q as C,y as p}from"./hooks.module.Bla9ZUYE.js";import{u as t}from"./jsxRuntime.module.BSCWCfwz.js";import"./preact.module.IsPPbktY.js";function R({searchIndex:h}){const[g,x]=c(!1),[l,m]=c(""),[s,b]=c([]),[u,d]=c(0),f=y(null),w=y(null),k=C(e=>{if(!e||e.trim().length<2)return[];const n=e.toLowerCase();return h.map(r=>{let o=0;const a=[];return r.title.toLowerCase().includes(n)&&(o+=10,a.push("title")),r.description.toLowerCase().includes(n)&&(o+=5,a.push("description")),r.tags.some(L=>L.toLowerCase().includes(n))&&(o+=3,a.push("tags")),r.language?.toLowerCase().includes(n)&&(o+=2,a.push("language")),{...r,score:o,match:a.join(", ")}}).filter(r=>r.score>0).sort((r,o)=>o.score-r.score).slice(0,10)},[h]);p(()=>{const e=()=>x(!0);return window.addEventListener("open-search",e),()=>window.removeEventListener("open-search",e)},[]),p(()=>(g?(f.current?.focus(),document.body.style.overflow="hidden"):(document.body.style.overflow="",m(""),b([]),d(0)),()=>{document.body.style.overflow=""}),[g]),p(()=>{const e=k(l);b(e),d(0)},[l,k]);const v=e=>{if(e.key==="Escape"){x(!1);return}e.key==="ArrowDown"?(e.preventDefault(),d(n=>(n+1)%s.length)):e.key==="ArrowUp"?(e.preventDefault(),d(n=>(n-1+s.length)%s.length)):e.key==="Enter"&&s[u]&&(window.location.href=`/blog/${s[u].slug}`)},N=(e,n)=>{if(!n)return e;const i=new RegExp(`(${n})`,"gi");return e.split(i).map((o,a)=>i.test(o)?t("mark",{className:"bg-yellow-200 dark:bg-yellow-700 rounded px-0.5",children:o},a):o)};return g?t("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[20vh] bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&x(!1),children:t("div",{className:"w-full max-w-2xl mx-4 bg-notion-bg dark:bg-notion-bg-dark rounded-xl shadow-2xl overflow-hidden",children:[t("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-notion-border dark:border-notion-border-dark",children:[t("svg",{className:"w-5 h-5 text-notion-text dark:text-notion-text-dark/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{color:"#6b6b6b"},children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),t("input",{ref:f,type:"text",value:l,onInput:e=>m(e.target.value),onKeyDown:v,placeholder:"Search posts, tags, or languages...",className:"flex-1 bg-transparent text-notion-text dark:text-notion-text-dark placeholder:text-notion-text dark:placeholder:text-notion-text-dark/50 focus:outline-none text-lg"}),t("kbd",{className:"hidden sm:inline-flex items-center px-2 py-1 text-xs font-mono bg-notion-gray dark:bg-notion-gray-dark rounded",children:"ESC"})]}),t("div",{ref:w,className:"max-h-[60vh] overflow-y-auto",children:l.length>0&&s.length===0?t("div",{className:"px-4 py-8 text-center text-notion-text dark:text-notion-text-dark/60",children:['No results found for "',l,'"']}):t("ul",{className:"py-2",children:s.map((e,n)=>t("li",{children:t("a",{href:`/blog/${e.slug}`,className:`block px-4 py-3 mx-2 rounded-lg transition-colors ${n===u?"bg-notion-blue-light dark:bg-blue-900/30":"hover:bg-notion-gray dark:hover:bg-notion-gray-dark"}`,onMouseEnter:()=>d(n),children:t("div",{className:"flex items-start justify-between gap-4",children:[t("div",{className:"flex-1 min-w-0",children:[t("h3",{className:"font-medium text-notion-text dark:text-notion-text-dark truncate",children:N(e.title,l)}),t("p",{className:"text-sm text-notion-text dark:text-notion-text-dark/60 line-clamp-1 mt-0.5",children:e.description})]}),t("div",{className:"flex items-center gap-2 shrink-0",children:[e.language&&t("span",{className:"px-2 py-0.5 text-xs rounded-full bg-notion-blue-light dark:bg-blue-900/30 text-notion-blue",children:e.language}),e.tags.slice(0,2).map(i=>t("span",{className:"hidden sm:inline-block px-2 py-0.5 text-xs rounded-full bg-notion-gray dark:bg-notion-gray-dark text-notion-text dark:text-notion-text-dark/70",children:i},i))]})]})})},e.id))})}),t("div",{className:"flex items-center justify-between px-4 py-2 text-xs text-notion-text dark:text-notion-text-dark/50 border-t border-notion-border dark:border-notion-border-dark bg-notion-gray/50 dark:bg-notion-gray-dark/30",children:[t("div",{className:"flex items-center gap-4",children:[t("span",{className:"flex items-center gap-1",children:[t("kbd",{className:"px-1.5 py-0.5 bg-notion-bg dark:bg-notion-bg-dark rounded",children:"↑↓"}),"to navigate"]}),t("span",{className:"flex items-center gap-1",children:[t("kbd",{className:"px-1.5 py-0.5 bg-notion-bg dark:bg-notion-bg-dark rounded",children:"↵"}),"to select"]})]}),t("span",{children:[s.length," results"]})]})]})}):null}export{R as default};
