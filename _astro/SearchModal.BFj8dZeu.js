import{d as x,A as v,q as N,y as g}from"./hooks.module.Bla9ZUYE.js";import{u as t}from"./jsxRuntime.module.BSCWCfwz.js";import"./preact.module.IsPPbktY.js";function C(p){return p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function R({searchIndex:p}){const[l,h]=x(!1),[d,b]=x(""),[n,k]=x([]),[c,u]=x(0),y=v(null),m=v(null),w=N(e=>{if(!e||e.trim().length<2)return[];const r=e.toLowerCase();return p.map(a=>{let o=0;const i=[];return a.title.toLowerCase().includes(r)&&(o+=10,i.push("title")),a.description.toLowerCase().includes(r)&&(o+=5,i.push("description")),a.tags.some(L=>L.toLowerCase().includes(r))&&(o+=3,i.push("tags")),a.language?.toLowerCase().includes(r)&&(o+=2,i.push("language")),{...a,score:o,match:i.join(", ")}}).filter(a=>a.score>0).sort((a,o)=>o.score-a.score).slice(0,10)},[p]);g(()=>{const e=()=>h(!0);return window.addEventListener("open-search",e),()=>window.removeEventListener("open-search",e)},[]),g(()=>(l?(y.current?.focus(),document.body.style.overflow="hidden"):(document.body.style.overflow="",b(""),k([]),u(0)),()=>{document.body.style.overflow=""}),[l]),g(()=>{const e=w(d);k(e),u(0)},[d,w]);const f=N(e=>{if(!(!l||!new Set(["Escape","ArrowDown","ArrowUp","Enter"]).has(e.key)&&(e.isComposing||e.keyCode===229))){if(e.key==="Escape"){e.preventDefault(),h(!1);return}if(n.length!==0){if(e.key==="ArrowDown"){e.preventDefault(),u(s=>(s+1)%n.length);return}if(e.key==="ArrowUp"){e.preventDefault(),u(s=>(s-1+n.length)%n.length);return}e.key==="Enter"&&n[c]&&(e.preventDefault(),window.location.href=`/blog/${n[c].slug}`)}}},[l,n,c]);g(()=>{if(l)return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[l,f]),g(()=>{if(!m.current||n.length===0)return;m.current.querySelectorAll("ul li a")[c]?.scrollIntoView({block:"nearest"})},[c,n.length]);const E=(e,r)=>{if(!r)return e;const s=new RegExp(`(${C(r)})`,"gi");return e.split(s).map((o,i)=>s.test(o)?t("mark",{className:"bg-yellow-200 dark:bg-yellow-700 rounded px-0.5",children:o},i):o)};return l?t("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[20vh] bg-black/50 backdrop-blur-sm",onClick:e=>e.target===e.currentTarget&&h(!1),children:t("div",{className:"w-full max-w-2xl mx-4 bg-notion-bg dark:bg-notion-bg-dark rounded-xl shadow-2xl overflow-hidden",children:[t("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-notion-border dark:border-notion-border-dark",children:[t("svg",{className:"w-5 h-5 text-notion-text dark:text-notion-text-dark/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),t("input",{ref:y,type:"text",value:d,onInput:e=>b(e.target.value),placeholder:"Search posts, tags, or languages...",className:"flex-1 bg-transparent text-notion-text dark:text-notion-text-dark placeholder:text-notion-text dark:placeholder:text-notion-text-dark/50 focus:outline-none text-lg"}),t("kbd",{className:"hidden sm:inline-flex items-center px-2 py-1 text-xs font-mono bg-notion-gray dark:bg-notion-gray-dark rounded",children:"ESC"})]}),t("div",{ref:m,className:"max-h-[60vh] overflow-y-auto",children:d.length>0&&n.length===0?t("div",{className:"px-4 py-8 text-center text-notion-text dark:text-notion-text-dark/60",children:['No results found for "',d,'"']}):t("ul",{className:"py-2",children:n.map((e,r)=>t("li",{children:t("a",{href:`/blog/${e.slug}`,className:`block px-4 py-3 mx-2 rounded-lg transition-colors ${r===c?"bg-notion-blue-light dark:bg-blue-900/30":"hover:bg-notion-gray dark:hover:bg-notion-gray-dark"}`,onMouseEnter:()=>u(r),children:t("div",{className:"flex items-start justify-between gap-4",children:[t("div",{className:"flex-1 min-w-0",children:[t("h3",{className:"font-medium text-notion-text dark:text-notion-text-dark truncate",children:E(e.title,d)}),t("p",{className:"text-sm text-notion-text dark:text-notion-text-dark/60 line-clamp-1 mt-0.5",children:e.description})]}),t("div",{className:"flex items-center gap-2 shrink-0",children:[e.language&&t("span",{className:"px-2 py-0.5 text-xs rounded-full bg-notion-blue-light dark:bg-blue-900/30 text-notion-blue",children:e.language}),e.tags.slice(0,2).map(s=>t("span",{className:"hidden sm:inline-block px-2 py-0.5 text-xs rounded-full bg-notion-gray dark:bg-notion-gray-dark text-notion-text dark:text-notion-text-dark/70",children:s},s))]})]})})},e.id))})}),t("div",{className:"flex items-center justify-between px-4 py-2 text-xs text-notion-text dark:text-notion-text-dark/50 border-t border-notion-border dark:border-notion-border-dark bg-notion-gray/50 dark:bg-notion-gray-dark/30",children:[t("div",{className:"flex items-center gap-4",children:[t("span",{className:"flex items-center gap-1",children:[t("kbd",{className:"px-1.5 py-0.5 bg-notion-bg dark:bg-notion-bg-dark rounded",children:"↑↓"}),"to navigate"]}),t("span",{className:"flex items-center gap-1",children:[t("kbd",{className:"px-1.5 py-0.5 bg-notion-bg dark:bg-notion-bg-dark rounded",children:"↵"}),"to select"]})]}),t("span",{children:[n.length," results"]})]})]})}):null}export{R as default};
